FuncionSolModelAcoplado<-function(VecPar,Yinicial,PeriodoDias,dt)
{ 
  VecParam_la<-VecPar[1:7]
  VecParam_ha<-VecPar
  VecTheta<-as.numeric(VecPar[8:9])
  SalidaSol<-list()
  s<-1
  for (i in 1:(length(PeriodoDias)-1))
  {
    RejillaTimes<-seq(PeriodoDias[s],PeriodoDias[s+1],dt)
    if((s+1)%%2==0)
    {
      Soltemp<-ode(Yinicial,RejillaTimes,FuncionModel_la,VecParam_la)
      dm<-dim(Soltemp)[1]
      yini_temp<-as.numeric(Soltemp[dm,])
      S11_0<-(1-VecTheta[1])*yini_temp[2]
      I11_0<-(1-VecTheta[1])*yini_temp[3]
      R11_0<-(1-VecTheta[1])*yini_temp[4]
      S21_0<-VecTheta[2]*yini_temp[7]
      I21_0<-VecTheta[2]*yini_temp[8]
      R21_0<-VecTheta[2]*yini_temp[9]
      Vs1_0<-yini_temp[5]
      Vi1_0<-yini_temp[6]
      S22_0<-(1.0-VecTheta[2])*yini_temp[7]
      I22_0<-(1.0-VecTheta[2])*yini_temp[8]
      R22_0<-(1.0-VecTheta[2])*yini_temp[9]
      S12_0<-VecTheta[1]*yini_temp[2]
      I12_0<-VecTheta[1]*yini_temp[3]
      R12_0<-VecTheta[1]*yini_temp[4]
      Vs2_0<-yini_temp[10]
      Vi2_0<-yini_temp[11]
      C1_0<-yini_temp[12]
      C2_0<-yini_temp[13]
      Yinicial<-c(S11=S11_0,I11=I11_0,R11=R11_0,S21=S21_0,I21=I21_0,R21=R21_0,Vs1=Vs1_0,Vi1=Vi1_0,
                  S22=S22_0,I22=I22_0,R22=R22_0,S12=S12_0,I12=I12_0,R12=R12_0,Vs2=Vs2_0,Vi2=Vi2_0,
                  C1=C1_0,C2=C2_0)
      SalidaSol[[s]]<-Soltemp[1:(dm-1),]
      s<-s+1
      }
    else
    {
      Soltemp<-ode(Yinicial,RejillaTimes,FuncionModel_ha,VecParam_ha)
      dm<-dim(Soltemp)[1]
      yini_temp<-as.numeric(Soltemp[dm,])
      S1_0<-yini_temp[2]+yini_temp[13]
      I1_0<-yini_temp[3]+yini_temp[14]
      R1_0<-yini_temp[4]+yini_temp[15]
      Vs1_0<-yini_temp[8]
      Vi1_0<-yini_temp[9]
      S2_0<-yini_temp[10]+yini_temp[5]
      I2_0<-yini_temp[11]+yini_temp[6]
      R2_0<-yini_temp[12]+yini_temp[7]
      Vs2_0<-yini_temp[16]
      Vi2_0<-yini_temp[17]
      C1_0<-yini_temp[18]
      C2_0<-yini_temp[19]
      Yinicial<-c(S1=S1_0,I1=I1_0,R1=R1_0,Vs1=Vs1_0,Vi1=Vi1_0,
                  S2=S2_0,I2=I2_0,R2=R2_0,Vs2=Vs2_0,Vi2=Vi2_0,
                  C1=C1_0,C2=C2_0)
      if(PeriodoDias[s+1]==PeriodoDias[length(PeriodoDias)])
      {
        dm<-dm+1
      }
      SalidaSol[[s]]<-cbind(time=Soltemp[1:(dm-1),1],
                           S1=Soltemp[1:(dm-1),2]+Soltemp[1:(dm-1),13],
                           I1=Soltemp[1:(dm-1),3]+Soltemp[1:(dm-1),14],
                           R1=Soltemp[1:(dm-1),4]+Soltemp[1:(dm-1),15],
                           Vs1=Soltemp[1:(dm-1),8],Vi1=Soltemp[1:(dm-1),9],
                           S2=Soltemp[1:(dm-1),5]+Soltemp[1:(dm-1),10],
                           I2=Soltemp[1:(dm-1),6]+Soltemp[1:(dm-1),11],
                           R2=Soltemp[1:(dm-1),7]+Soltemp[1:(dm-1),12],
                           Vs2=Soltemp[1:(dm-1),16],Vi2=Soltemp[1:(dm-1),17],
                           C1=Soltemp[1:(dm-1),18],C2=Soltemp[1:(dm-1),19])
      s<-s+1
    }
  }
  Sol<-SalidaSol[[1]]
  for(j in 2:(s-1))
  {
    Sol<-rbind(Sol,SalidaSol[[j]])
  }
  return(Sol)
}